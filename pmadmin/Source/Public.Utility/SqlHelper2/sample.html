<h1 style="box-sizing: border-box; font-size: 2em; margin-top: 0px !important; margin-right: 0px; margin-bottom: 16px; margin-left: 0px; font-weight: 600; line-height: 1.25; padding-bottom: 0.3em; border-bottom: 1px solid rgb(234, 236, 239); color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Quick Start Guide</h1>
<h3 style="box-sizing: border-box; margin-top: 24px; margin-bottom: 16px; font-size: 1.25em; font-weight: 600; line-height: 1.25; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
    <a id="user-content-configurate-connection-string" aria-hidden="true" class="anchor" href="https://github.com/liunaijia/sqlhelper2#configurate-connection-string" style="box-sizing: border-box; background-color: transparent; color: rgb(3, 102, 214); text-decoration: none; float: left; padding-right: 4px; margin-left: -20px; line-height: 1;">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
        <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg>
    </a>Configurate Connection String</h3>
<blockquote style="box-sizing: border-box; margin: 0px 0px 16px; padding: 0px 1em; color: rgb(106, 115, 125); border-left: 0.25em solid rgb(223, 226, 229); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
    <p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;">
        As usual, setting the<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; padding: 0.2em 0px; margin: 0px; background-color: rgba(27, 31, 35, 0.0470588); border-radius: 3px;">connectionString</code><span class="Apple-converted-space">&nbsp;</span>and<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; padding: 0.2em 0px; margin: 0px; background-color: rgba(27, 31, 35, 0.0470588); border-radius: 3px;">providerName</code>.</p>
</blockquote>
<div class="highlight highlight-text-xml" style="box-sizing: border-box; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
    <pre style="box-sizing: border-box; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; margin-top: 0px; margin-bottom: 0px; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; line-height: 1.45; word-wrap: normal; padding: 16px; overflow: auto; background-color: rgb(246, 248, 250); border-radius: 3px; word-break: normal;">&lt;?<span class="pl-ent" style="box-sizing: border-box; color: rgb(99, 163, 92);">xml</span><span class="pl-e" style="box-sizing: border-box; color: rgb(121, 93, 163);"> version</span>=<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>1.0<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span><span class="pl-e" style="box-sizing: border-box; color: rgb(121, 93, 163);"> encoding</span>=<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>utf-8<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span> ?&gt;
&lt;<span class="pl-ent" style="box-sizing: border-box; color: rgb(99, 163, 92);">configuration</span>&gt;
  &lt;<span class="pl-ent" style="box-sizing: border-box; color: rgb(99, 163, 92);">connectionStrings</span>&gt;
    &lt;<span class="pl-ent" style="box-sizing: border-box; color: rgb(99, 163, 92);">add</span> <span class="pl-e" style="box-sizing: border-box; color: rgb(121, 93, 163);">name</span>=<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>mall<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span> <span class="pl-e" style="box-sizing: border-box; color: rgb(121, 93, 163);">connectionString</span>=<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>Data Source=localhost;Initial Catalog=mall;User ID=sa;Password=***<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span> <span class="pl-e" style="box-sizing: border-box; color: rgb(121, 93, 163);">providerName</span>=<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>System.Data.SqlClient<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span>/&gt;
  &lt;/<span class="pl-ent" style="box-sizing: border-box; color: rgb(99, 163, 92);">connectionStrings</span>&gt;
&lt;/<span class="pl-ent" style="box-sizing: border-box; color: rgb(99, 163, 92);">configuration</span>&gt;</pre>
</div>
<h3 style="box-sizing: border-box; margin-top: 24px; margin-bottom: 16px; font-size: 1.25em; font-weight: 600; line-height: 1.25; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><a id="user-content-insert" aria-hidden="true" class="anchor" href="https://github.com/liunaijia/sqlhelper2#insert" style="box-sizing: border-box; background-color: transparent; color: rgb(3, 102, 214); text-decoration: none; float: left; padding-right: 4px; margin-left: -20px; line-height: 1;">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
        <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg>
    </a>Insert</h3>
<blockquote style="box-sizing: border-box; margin: 0px 0px 16px; padding: 0px 1em; color: rgb(106, 115, 125); border-left: 0.25em solid rgb(223, 226, 229); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
    <p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;">
        Using anonymous object to build SQL parameters.</p>
</blockquote>
<div class="highlight highlight-source-cs" style="box-sizing: border-box; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
    <pre style="box-sizing: border-box; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; margin-top: 0px; margin-bottom: 0px; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; line-height: 1.45; word-wrap: normal; padding: 16px; overflow: auto; background-color: rgb(246, 248, 250); border-radius: 3px; word-break: normal;"><span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">public</span> <span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">void</span> <span class="pl-en" style="box-sizing: border-box; color: rgb(121, 93, 163);">Save</span>() {
	DatabaseFactory.CreateDatabase(<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>mall<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span>).ExecuteNonQuery(
		<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">@&quot;insert into [Order](OrderId, Status, CreatedTime, TotalPrice) values(@OrderId, @Status, @CreatedTime, @TotalPrice)&quot;</span></span>,
		new {
			OrderId = Guid.NewGuid().ToString(<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>N<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span>),
			Status = <span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>newcreated<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span>,
			CreatedTime = DateTime.Now,
			TotalPrice = <span class="pl-c1" style="box-sizing: border-box; color: rgb(0, 134, 179);">89.2</span>
		});
}</pre>
</div>
<h3 style="box-sizing: border-box; margin-top: 24px; margin-bottom: 16px; font-size: 1.25em; font-weight: 600; line-height: 1.25; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><a id="user-content-update" aria-hidden="true" class="anchor" href="https://github.com/liunaijia/sqlhelper2#update" style="box-sizing: border-box; background-color: transparent; color: rgb(3, 102, 214); text-decoration: none; float: left; padding-right: 4px; margin-left: -20px; line-height: 1;">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
        <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg>
    </a>Update</h3>
<blockquote style="box-sizing: border-box; margin: 0px 0px 16px; padding: 0px 1em; color: rgb(106, 115, 125); border-left: 0.25em solid rgb(223, 226, 229); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
    <p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;">
        Field name could be ignored if parameter name is same with anonymous object property name.</p>
</blockquote>
<div class="highlight highlight-source-cs" style="box-sizing: border-box; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
    <pre style="box-sizing: border-box; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; margin-top: 0px; margin-bottom: 0px; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; line-height: 1.45; word-wrap: normal; padding: 16px; overflow: auto; background-color: rgb(246, 248, 250); border-radius: 3px; word-break: normal;"><span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">public</span> <span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">void</span> <span class="pl-en" style="box-sizing: border-box; color: rgb(121, 93, 163);">UpdateStatus</span>(<span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">string</span> <span class="pl-smi" style="box-sizing: border-box; color: rgb(51, 51, 51);">orderId</span>, <span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">int</span> <span class="pl-smi" style="box-sizing: border-box; color: rgb(51, 51, 51);">targetStatus</span>) {
	DatabaseFactory.CreateDatabase(<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>mall<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span>).ExecuteNonQuery(
		<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">@&quot;update [Order] set Status = @targetStatus where OrderId = @orderId&quot;</span></span>,
		new {orderId, targetStatus});
}</pre>
</div>
<h3 style="box-sizing: border-box; margin-top: 24px; margin-bottom: 16px; font-size: 1.25em; font-weight: 600; line-height: 1.25; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><a id="user-content-transaction" aria-hidden="true" class="anchor" href="https://github.com/liunaijia/sqlhelper2#transaction" style="box-sizing: border-box; background-color: transparent; color: rgb(3, 102, 214); text-decoration: none; float: left; padding-right: 4px; margin-left: -20px; line-height: 1;">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
        <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg>
    </a>Transaction</h3>
<blockquote style="box-sizing: border-box; margin: 0px 0px 16px; padding: 0px 1em; color: rgb(106, 115, 125); border-left: 0.25em solid rgb(223, 226, 229); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
    <p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;">
        Committing transaction if code in<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; padding: 0.2em 0px; margin: 0px; background-color: rgba(27, 31, 35, 0.0470588); border-radius: 3px;">ExecuteTransaction</code><span class="Apple-converted-space">&nbsp;</span>block doesn&#39;t throw an exception, otherwise rollbacking transaction.</p>
</blockquote>
<div class="highlight highlight-source-cs" style="box-sizing: border-box; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
    <pre style="box-sizing: border-box; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; margin-top: 0px; margin-bottom: 0px; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; line-height: 1.45; word-wrap: normal; padding: 16px; overflow: auto; background-color: rgb(246, 248, 250); border-radius: 3px; word-break: normal;"><span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">public</span> <span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">void</span> <span class="pl-en" style="box-sizing: border-box; color: rgb(121, 93, 163);">DecreaseSellableInventory</span>(<span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">string</span> <span class="pl-smi" style="box-sizing: border-box; color: rgb(51, 51, 51);">sku</span>, <span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">int</span> <span class="pl-smi" style="box-sizing: border-box; color: rgb(51, 51, 51);">decreasedAmount</span>) {
    DatabaseFactory.CreateDatabase(<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>mall<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span>).ExecuteTransaction(db =&gt; {
        <span class="pl-c" style="box-sizing: border-box; color: rgb(150, 152, 150);">// Update sellable amount</span>
        db.ExecuteNonQuery(<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>update Inventory set Sellable -= decreasedAmount where SkuId = @sku<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span>,
            new {sku, decreasedAmount});

        <span class="pl-c" style="box-sizing: border-box; color: rgb(150, 152, 150);">// Get amount after updating</span>
        <span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">var</span> <span class="pl-en" style="box-sizing: border-box; color: rgb(121, 93, 163);">sellableAmount </span>= db.ExecuteScalar&lt;<span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">int</span>&gt;(<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>select Sellable from Inventory where SkuId = @sku<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span>,
            new {sku});

        <span class="pl-c" style="box-sizing: border-box; color: rgb(150, 152, 150);">// ...Throw an exception to rollback transaction if amount is negative</span>
        <span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">if</span> (sellableAmount &lt; <span class="pl-c1" style="box-sizing: border-box; color: rgb(0, 134, 179);">0</span>)
            <span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">throw</span> <span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">new</span> <span class="pl-en" style="box-sizing: border-box; color: rgb(121, 93, 163);">ApplicationException</span>(<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>sellable amount can&#39;t be negative.<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span>);

        <span class="pl-c" style="box-sizing: border-box; color: rgb(150, 152, 150);">// ...Set SKU state to offline if it&#39;s amount is zero</span>
        <span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">if</span> (sellableAmount == <span class="pl-c1" style="box-sizing: border-box; color: rgb(0, 134, 179);">0</span>)
            db.ExecuteNonQuery(<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>update Sku set Status = @targetStatus where SkuId = @sku<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span>,
                new {<span class="pl-en" style="box-sizing: border-box; color: rgb(121, 93, 163);">sku</span>, <span class="pl-en" style="box-sizing: border-box; color: rgb(121, 93, 163);">targetStatus</span> = <span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>offline<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span>});

        <span class="pl-c" style="box-sizing: border-box; color: rgb(150, 152, 150);">// If any exception was thrown in above code block, such as database is disconnected, sql statement is wrong, database constraints are violated, rollback the whole transaction, otherwise commit it.</span>
    });
}</pre>
</div>
<h3 style="box-sizing: border-box; margin-top: 24px; margin-bottom: 16px; font-size: 1.25em; font-weight: 600; line-height: 1.25; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><a id="user-content-query" aria-hidden="true" class="anchor" href="https://github.com/liunaijia/sqlhelper2#query" style="box-sizing: border-box; background-color: transparent; color: rgb(3, 102, 214); text-decoration: none; float: left; padding-right: 4px; margin-left: -20px; line-height: 1;">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
        <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg>
    </a>Query</h3>
<blockquote style="box-sizing: border-box; margin: 0px 0px 16px; padding: 0px 1em; color: rgb(106, 115, 125); border-left: 0.25em solid rgb(223, 226, 229); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
    <ul style="box-sizing: border-box; padding-left: 2em; margin-top: 0px; margin-bottom: 0px;">
        <li style="box-sizing: border-box;">Using delegate to read data from<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; padding: 0.2em 0px; margin: 0px; background-color: rgba(27, 31, 35, 0.0470588); border-radius: 3px;">DataReader</code><span class="Apple-converted-space">&nbsp;</span>and fill data into business object.</li>
    </ul>
</blockquote>
<ul style="box-sizing: border-box; padding-left: 2em; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
    <li style="box-sizing: border-box;"><strong style="box-sizing: border-box; font-weight: 600;">NOTICE</strong>: the return value of<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; padding: 0.2em 0px; margin: 0px; background-color: rgba(27, 31, 35, 0.0470588); border-radius: 3px;">IEnumerable</code><span class="Apple-converted-space">&nbsp;</span>type is deferred execution, which means it doesn&#39;t execute any code when it&#39;s executed, until actual filtering/ordering/projecting is asked. So it will cause repeated execution if not using properly.</li>
</ul>
<div class="highlight highlight-source-cs" style="box-sizing: border-box; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
    <pre style="box-sizing: border-box; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; margin-top: 0px; margin-bottom: 0px; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; line-height: 1.45; word-wrap: normal; padding: 16px; overflow: auto; background-color: rgb(246, 248, 250); border-radius: 3px; word-break: normal;"><span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">public</span> <span class="pl-en" style="box-sizing: border-box; color: rgb(121, 93, 163);">IEnumerable</span>&lt;<span class="pl-en" style="box-sizing: border-box; color: rgb(121, 93, 163);">Order</span>&gt; <span class="pl-en" style="box-sizing: border-box; color: rgb(121, 93, 163);">GetOrdersByStatus</span>(<span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">string</span> <span class="pl-smi" style="box-sizing: border-box; color: rgb(51, 51, 51);">status</span>) {
    <span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">return</span> DatabaseFactory.CreateDatabase(<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>mall<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span>).ExecuteDataReader(
        <span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">@&quot;select * from [Order] where Status = @status&quot;</span></span>,
        new { status },
        dr =&gt; <span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">new</span> <span class="pl-en" style="box-sizing: border-box; color: rgb(121, 93, 163);">Order</span> {
            OrderId = (<span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">string</span>)dr[<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>OrderId<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span>],
            Status = (<span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">string</span>)dr[<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>Status<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span>],
            CreatedTime = (<span class="pl-en" style="box-sizing: border-box; color: rgb(121, 93, 163);">DateTime</span>)dr[<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>CreatedTime<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span>],
            TotalPrice = (<span class="pl-k" style="box-sizing: border-box; color: rgb(167, 29, 93);">decimal</span>)dr[<span class="pl-s" style="box-sizing: border-box; color: rgb(24, 54, 145);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span>TotalPrice<span class="pl-pds" style="box-sizing: border-box; color: rgb(24, 54, 145);">&quot;</span></span>]
        });
}</pre>
</div>
